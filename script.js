function buildRequest(a){return url+query.replace("%s",a)}function httpGetAsync(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status?b(c.responseText):200!=c.status&&0!=c.status&&console.log("error - http_status:"+c.status)},c.open("GET",a,!0),$("#message_div").text("Fetching results"),$("#results_div").hide(),c.send(null)}function fahrenheitToCelcius(a){return((a-32)/1.8).toFixed(0)}function displayWeather(a){void 0!=a?(a=a.slice(0,5),window.currentForecast=a):a=window.currentForecast,$.each(a,function(a,b){var c='<div class="date">'+b.day+","+b.date+'</div><div class="weather_text">'+b.text+"</div>";c+=$("#convert_to_celcius_checkbox").prop("checked")?'<div class="temphigh"> Max:'+fahrenheitToCelcius(b.high)+'C</div><div class="templow"> Min: '+fahrenheitToCelcius(b.low)+"C</div>":'<div class="temphigh"> Max: '+b.high+'F</div><div class="templow"> Min: '+b.low+"F</div>";$(".day[data-day="+a+"]").html(c)})}function getWeather(){var a=$("#location_input").val(),b=buildRequest(a);httpGetAsync(b,parseWeather)}var query='select * from weather.forecast where woeid in (select woeid from geo.places(1) where text="%s")',url="https://query.yahooapis.com/v1/public/yql?format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&q=",parseWeather=function(a){if(weatherData=JSON.parse(a),null!=weatherData.query.results){var b=weatherData.query.results.channel.item;$("#message_div").html("<b>"+b.title+'</b> <span class="smalltext"> lat. '+b.lat+", long. "+b["long"]+"</span>"),displayWeather(b.forecast),$("#results_div").show()}else $("#message_div").text("Coudn't find weather conditions for "+$("#location_input").val()),$("#results_div").hide()};$(function(){var a;$("#location_input").on("keyup",function(){clearTimeout(a),a=setTimeout(getWeather,500)}),$("#convert_to_celcius_checkbox").change(function(){displayWeather()}),$("#results_div").hide()});