function buildRequest(a){return url+query.replace("%s",a)}function httpGetAsync(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status?b(c.responseText):200!=c.status&&0!=c.status&&console.log("error - http_status:"+c.status)},c.open("GET",a,!0),c.send(null)}function fahrenheitToCelcius(a){return((a-32)/1.8).toFixed(0)}var query='select * from weather.forecast where woeid in (select woeid from geo.places(1) where text="%s")',url="https://query.yahooapis.com/v1/public/yql?format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&q=";!function(){var a=angular.module("weather",[]);a.controller("WeatherController",["$scope","$timeout",function(a,b){function c(b){if(b.length>0){a.forecast=[],a.weatherItem=!1,a.location=b;var c=buildRequest(b);a.message="Fetching results",httpGetAsync(c,f)}else a.message=""}var d=500;a.temperature_unit="F",a.convertTemperature=function(b){return"C"==a.temperature_unit?fahrenheitToCelcius(b):b};var e,f=function(b){var c=JSON.parse(b);null!=c.query.results?(a.weatherItem=c.query.results.channel.item,a.message="",a.forecast=a.weatherItem.forecast):a.message="Coudn't find weather conditions for "+a.location,a.$apply()};this.locationInput=function(a){b.cancel(e),e=b(function(){c(a.target.value)},d)}}]),a.directive("successMessage",function(){return{template:'<b> {{weatherItem.title}} </b> <span class="smalltext"> lat.  {{weatherItem.lat}} , long.  {{weatherItem.long}} </span>',restrict:"E"}})}();